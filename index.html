<!DOCTYPE html>
<html lang="en">
    <head>
<link rel="icon" href="/web/fav.svg" />
<link rel="stylesheet" href="paraloader-gpag/web/home.css">
		</head>
    <nav>
      <h1 class="title-stripe">ParaLoader</h1>
        <div class="nav-wrap">
        <div class="navigation">
            <p> 
                <svg class="svg-settings" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                  </svg>
                  <a href="/web/about.html"><span class="setting-nav">About</span></a>
                <svg class="svg-settings" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg> <a href="/web/modules.html"><span class="setting-nav">Modules</span></a> 

              <a href="DISCORD HERE IG"><span class="info-nav">Discord</span></a> 
              <svg class="svg-info" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 127.14 96.36"><defs><style>.cls-1{fill:#fff;}</style></defs><g id="图层_2" data-name="图层 2"><g id="Discord_Logos" data-name="Discord Logos"><g id="Discord_Logo_-_Large_-_White" data-name="Discord Logo - Large - White"><path class="cls-1" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.7,77.7,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22h0C129.24,52.84,122.09,29.11,107.7,8.07ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/></g></g></g></svg>
              <a href="#"><span class="info-nav" onclick="attemptUpdate();">Install</span></a> 
              <svg class="svg-info" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0111.186 0z" />
              </svg> 
              
              
            </p>
        </div>
    </div>
    <br>
									<p>Connection status is: <pre id="status"></pre></p>
																		<div class="center">
        <h1 class="tile-text"><a href="/paraloader/launcher.html" class="tile-text"> Demo </a></h1>
      </div>
    </nav>
    <br><br><br>
    </body> 
		<script src="web/decompile.js"></script>
    <script src="web/status.js"></script>
				<script>
	async function attemptUpdate(){
    const LOCAL_VERSION = "0.0";
    const services = [
        "://paraloader.paragram.repl.co"
    ];
    let v = LOCAL_VERSION;
    let vp = "";
    for(let i in services){
        try{
            let newVersion = await fetch("https"+services[i]+"/version.txt");
            newVersion = await newVersion.json();
            v=newVersion;
            vp = i;
            //future update: take most "popular" version number as actual
            break;
        } catch(e){
						alert("could not fetch version, maybe connect to internet?")
            console.log(`Failed to get update service ${i}: ${services[i]} failed`);
            continue;
        }
    }
    if(v["version"] == LOCAL_VERSION){
        alert("Up to date");
    } else {
        if(parseFloat(LOCAL_VERSION) < parseFloat(v["version"])){
            let ni = confirm("New update avaliable: \n -Version: "+v["version"]+"\n -Description: "+v["description"]+"\nInstall now?");
            if(ni){
                try{
								const url = 'https://corsproxy.io/?' + encodeURIComponent('https://codeload.github.com/Paragramex/paraloader/zip/refs/heads/main');
                let files = await fetch(url);
                //download repo zip, extract, filter for /paraloader/, write each file to user selected directory
                files = await files.blob();
                let k = await (new zip.ZipReader(new zip.BlobReader(files))).getEntries();
                alert("select ParaLoaders current directory");
                const d = await window.showDirectoryPicker({
                    id: "paraloader"
                });
                let dir = {};
                for(let i in k){
                       if(k[i].filename.indexOf("/paraloader/") != -1 && k[i].filename.split("/paraloader/")[1] != "" && k[i].filename[k[i].filename.length-1] != "/"){
                        let name = k[i].filename.replace("paraloader-main/paraloader/", "");
                        let dirs = name.split("/");
                        let filename;
                        let targetDirectoryHandle = d;
                        for(let i in dirs){
                            if(dirs.length-1!=i){
                                if(dir[dirs[i]] == undefined){
                                    //if target directory handle does not exist, make it
                                    console.log(`Attempting creation of directory ${dirs[i]}`);
                                    dir[dirs[i]] = await d.getDirectoryHandle(dirs[i], {create: true});
                                    console.log(`Created directory handle for ${dirs[i]}`);
                                }
                                targetDirectoryHandle = dir[dirs[i]];
                            } else {
                                filename = dirs[i];
                            }
                        }
                        let data = await k[i].getData(new zip.BlobWriter());
                        console.log(`Attempting to write ${name}`);
                        const cm = await targetDirectoryHandle.getFileHandle(filename, { create: true });
                        const cmf = await cm.createWritable();
                        await cmf.write(await data.text());
                        await cmf.close();
                        console.log("wrote");
                    }
                }
                }catch(e){
                    console.error(e);
										alert("Please raise an issue on the github to report this error if you followed through with the download, if you canceled or didnt download than ignore this: " + e)
                }
            }
        } else {
            alert("You appear to be ahead of the most recent version, very sus");
        }
    }
};
									</script>
</html>
	    
